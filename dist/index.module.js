var t=function(){var t=function(){function t(t){var e=(void 0===t?{}:t).strict;this.strict=void 0!==e&&e,this.rules=new Map,this.policies=new Map,this.registry=new WeakMap}var e=t.prototype;return e.rule=function(e,r,i){var n,o,s=this;void 0===i&&(i=!0),"boolean"==typeof(o=r)||void 0===o||"function"==typeof o&&""===o.name?(i=void 0===r||r,n=t.GlobalRule):n=r;var c=this.verbObjectMapper(n);return(Array.isArray(e)?e:[e]).forEach(function(t){var e=s.rules.get(c)||{};e[t]=i,s.rules.set(c,e)}),this},e.policy=function(t,e){var r="function"==typeof t?new t:t,i=this.verbObjectMapper(e);return this.policies.set(i,r),this},e.register=function(t,e){return this.registry.set(t,e),this},e.can=function(e,r,i){void 0===i&&(i=void 0);var n=[].slice.call(arguments,3),o=this.verbObjectMapper(i=void 0===i?t.GlobalRule:i),s=this.policies.get(o),c=s||this.rules.get(o);if(void 0===c){if(this.strict)throw new Error('No rules for verb object "'+o+'"');return!1}if(s&&"function"==typeof s.beforeAll){var a=s.beforeAll.apply(s,[r,e,i,o].concat(n));if(void 0!==a)return a}if("function"==typeof c[r])return Boolean(c[r].apply(c,[e,i,o].concat(n)));if(this.strict&&void 0===c[r])throw new Error('Unknown verb "'+r+'"');return Boolean(c[r])},e.some=function(t,e,r){var i=arguments,n=this;return r.some(function(r){return n.can.apply(n,[t,e,r].concat([].slice.call(i,3)))})},e.every=function(t,e,r){var i=arguments,n=this;return r.every(function(r){return n.can.apply(n,[t,e,r].concat([].slice.call(i,3)))})},e.mixin=function(t){var e=this;return t.prototype.can=function(t,r){return e.can.apply(e,[this,t,r].concat([].slice.call(arguments,2)))},t.prototype.can.every=function(t,r){return e.every.apply(e,[this,t,r].concat([].slice.call(arguments,2)))},t.prototype.can.some=function(t,r){return e.some.apply(e,[this,t,r].concat([].slice.call(arguments,2)))},this},e.verbObjectMapper=function(t){return"string"==typeof t?t:this.registry.has(t)?this.registry.get(t):this.registry.has(t.constructor)?this.registry.get(t.constructor):"function"==typeof t?t.name:t.constructor.name},e.reset=function(){return this.rules=new Map,this.policies=new Map,this.registry=new WeakMap,this},e.removeRules=function(t,e){void 0===e&&(e=null);var r=this.verbObjectMapper(t);if(this.rules.has(r)){if(e){var i=this.rules.get(r);return i&&delete i[e],this}this.rules.delete(r)}return this},e.removePolicy=function(t){var e=this.verbObjectMapper(t);return this.policies.delete(e),this},e.removeAll=function(t){return this.removeRules(t),this.removePolicy(t),this},t}();return t.GlobalRule="GLOBAL_RULE",t}();export default t;
//# sourceMappingURL=index.module.js.map
