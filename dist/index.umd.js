!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).BrowserAcl=t()}(this,function(){return(e=function(){function e(e){var t=(void 0===e?{}:e).strict;this.strict=void 0!==t&&t,this.rules=new Map,this.policies=new Map,this.registry=new WeakMap}var t=e.prototype;return t.rule=function(t,r,i){var n,o,s=this;void 0===i&&(i=!0),"boolean"==typeof(o=r)||void 0===o||"function"==typeof o&&""===o.name?(i=void 0===r||r,n=e.GlobalRule):n=r;var c=this.verbObjectMapper(n);return(Array.isArray(t)?t:[t]).forEach(function(e){var t=s.rules.get(c)||{};t[e]=i,s.rules.set(c,t)}),this},t.policy=function(e,t){var r="function"==typeof e?new e:e,i=this.verbObjectMapper(t);return this.policies.set(i,r),this},t.register=function(e,t){return this.registry.set(e,t),this},t.can=function(t,r,i){void 0===i&&(i=void 0);var n=[].slice.call(arguments,3),o=this.verbObjectMapper(i=void 0===i?e.GlobalRule:i),s=this.policies.get(o),c=s||this.rules.get(o);if(void 0===c){if(this.strict)throw new Error('No rules for verb object "'+o+'"');return!1}if(s&&"function"==typeof s.beforeAll){var u=s.beforeAll.apply(s,[r,t,i,o].concat(n));if(void 0!==u)return u}if("function"==typeof c[r])return Boolean(c[r].apply(c,[t,i,o].concat(n)));if(this.strict&&void 0===c[r])throw new Error('Unknown verb "'+r+'"');return Boolean(c[r])},t.some=function(e,t,r){var i=arguments,n=this;return r.some(function(r){return n.can.apply(n,[e,t,r].concat([].slice.call(i,3)))})},t.every=function(e,t,r){var i=arguments,n=this;return r.every(function(r){return n.can.apply(n,[e,t,r].concat([].slice.call(i,3)))})},t.mixin=function(e){var t=this;return e.prototype.can=function(e,r){return t.can.apply(t,[this,e,r].concat([].slice.call(arguments,2)))},e.prototype.can.every=function(e,r){return t.every.apply(t,[this,e,r].concat([].slice.call(arguments,2)))},e.prototype.can.some=function(e,r){return t.some.apply(t,[this,e,r].concat([].slice.call(arguments,2)))},this},t.verbObjectMapper=function(e){return"string"==typeof e?e:this.registry.has(e)?this.registry.get(e):this.registry.has(e.constructor)?this.registry.get(e.constructor):"function"==typeof e?e.name:e.constructor.name},t.reset=function(){return this.rules=new Map,this.policies=new Map,this.registry=new WeakMap,this},t.removeRules=function(e,t){void 0===t&&(t=null);var r=this.verbObjectMapper(e);if(this.rules.has(r)){if(t){var i=this.rules.get(r);return i&&delete i[t],this}this.rules.delete(r)}return this},t.removePolicy=function(e){var t=this.verbObjectMapper(e);return this.policies.delete(t),this},t.removeAll=function(e){return this.removeRules(e),this.removePolicy(e),this},e}()).GlobalRule="GLOBAL_RULE",e;var e});
//# sourceMappingURL=index.umd.js.map
